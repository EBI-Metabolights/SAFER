<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Function reference â€¢ ImperialNMRTool</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Function reference"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-index">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ImperialNMRTool</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
    <div class="page-header">
      <h1>Reference</h1>
    </div>

    <table class="ref-index"><colgroup><col class="alias"><col class="title"></colgroup><tbody><tr><th colspan="2">
          <h2 id="all-functions">All functions <a href="#all-functions" class="anchor" aria-hidden="true"></a></h2>
          <p class="section-desc"></p>
        </th>
      </tr></tbody><tbody><tr><td>
          <p><code><a href="align.max.html">align.max()</a></code> </p>
        </td>
        <td><p>Aligns the features in the input matrix based on their maximum peaks</p></td>
      </tr><tr><td>
          <p><code><a href="backfit_ref.feats.2.subset.specs.html">backfit_ref.feats.2.subset.specs()</a></code> </p>
        </td>
        <td><p>Back-fit reference features to a subset of spectra</p></td>
      </tr><tr><td>
          <p><code><a href="bad.peaks.html">bad.peaks()</a></code> </p>
        </td>
        <td><p>Calculate how often each feature point is fit across the reference database</p></td>
      </tr><tr><td>
          <p><code><a href="clusts2labs.html">clusts2labs()</a></code> </p>
        </td>
        <td><p>Convert clusters to feature-sorted cluster labels</p></td>
      </tr><tr><td>
          <p><code><a href="corrPocketPairs_al.html">corrPocketPairs_al()</a></code> </p>
        </td>
        <td><p>corrPocketPairs</p></td>
      </tr><tr><td>
          <p><code><a href="corr_expand.html">corr_expand()</a></code> </p>
        </td>
        <td><p>Expand a peak region to the closest correlation minimums</p></td>
      </tr><tr><td>
          <p><code><a href="corr_expand_window.html">corr_expand_window()</a></code> </p>
        </td>
        <td><p>Expand a correlation window around a given peak index to the nearest correlation minima outside of the window
bounds.</p></td>
      </tr><tr><td>
          <p><code><a href="detect.baseline.effect.html">detect.baseline.effect()</a></code> </p>
        </td>
        <td><p>Detect baseline effect in feature profile (also indicates monotonic features, which are easy to get with STORM)
Goes through a couple of checks:
- is the peak prominence (max vs. lower bound) of at least one peak &gt; prom.ratio x the entire feature intensity range
- do the valleys and peaks in the feature profile correlate strongly (r &gt; cutoff.corr)? If so, likely a baseline effect.</p></td>
      </tr><tr><td>
          <p><code><a href="earlyOut.html">earlyOut()</a></code> </p>
        </td>
        <td><p>Return early output for `xcorr` if no comparisons should be computed</p></td>
      </tr><tr><td>
          <p><code><a href="errorOut.html">errorOut()</a></code> </p>
        </td>
        <td><p>Create an error output object with default values.</p></td>
      </tr><tr><td>
          <p><code><a href="expand_window.html">expand_window()</a></code> </p>
        </td>
        <td><p>Expand a window by a certain distance while keeping indices within a given range.</p></td>
      </tr><tr><td>
          <p><code><a href="extractPeaks_corr.html">extractPeaks_corr()</a></code> </p>
        </td>
        <td><p>Extract local maxima and minima from a correlation vector</p></td>
      </tr><tr><td>
          <p><code><a href="feature_match2ref_slim.html">feature_match2ref_slim()</a></code> </p>
        </td>
        <td><p>Match a feature against a reference using FFT-based convolution and correlation
picks the top max.hits peaks in the convolution, then calculates correlation and
pvalue of the PCC at those points in the ref.
Returns a dataframe with the xcorr information.</p></td>
      </tr><tr><td>
          <p><code><a href="fillbetween.html">fillbetween()</a></code> </p>
        </td>
        <td><p>fillbetween</p></td>
      </tr><tr><td>
          <p><code><a href="filter.matches.html">filter(<i>&lt;matches&gt;</i>)</a></code> </p>
        </td>
        <td><p>Match Filtering</p></td>
      </tr><tr><td>
          <p><code><a href="filter.matches_shiftDelta.html">filter(<i>&lt;matches_shiftDelta&gt;</i>)</a></code> </p>
        </td>
        <td><p>Filter matches based on ppm shift difference</p></td>
      </tr><tr><td>
          <p><code><a href="filter.matches_singlets.html">filter(<i>&lt;matches_singlets&gt;</i>)</a></code> </p>
        </td>
        <td><p>Filter matches with singlets</p></td>
      </tr><tr><td>
          <p><code><a href="filterFeatures.html">filterFeatures()</a></code> </p>
        </td>
        <td><p>Filter features based on specified criteria
- null features
- features outside of ppm range
- features with no runs &gt;= min.runlength
- features derived from &lt; min.subset spectra
- features with strong baseline effect</p></td>
      </tr><tr><td>
          <p><code><a href="fit.batman.html">fit.batman()</a></code> </p>
        </td>
        <td><p>Fit a two-component model to a feature and a reference spectrum</p></td>
      </tr><tr><td>
          <p><code><a href="fit.leastSquares.html">fit.leastSquares()</a></code> </p>
        </td>
        <td><p>Fit least squares model between two signals and calculate statistics</p></td>
      </tr><tr><td>
          <p><code><a href="fit.minmax.html">fit.minmax()</a></code> </p>
        </td>
        <td><p>Fit a feature to a spectrum using minmax scaling</p></td>
      </tr><tr><td>
          <p><code><a href="fitFeature.html">fitFeature()</a></code> </p>
        </td>
        <td><p>Fit a feature to a spectrum</p></td>
      </tr><tr><td>
          <p><code><a href="fse.html">fse()</a></code> </p>
        </td>
        <td><p>FSE Function</p></td>
      </tr><tr><td>
          <p><code><a href="fwhm.html">fwhm()</a></code> </p>
        </td>
        <td><p>Full Width at Half Maximum (FWHM) calculation</p></td>
      </tr><tr><td>
          <p><code><a href="ind2subR.html">ind2subR()</a></code> </p>
        </td>
        <td><p>Convert linear indices to row and column subscripts</p></td>
      </tr><tr><td>
          <p><code><a href="is.true.peak.html">is.true.peak()</a></code> </p>
        </td>
        <td><p>Label True Peak points in a vector using extractPeaks_corr (wrapper)</p></td>
      </tr><tr><td>
          <p><code><a href="keep_inds_in_bounds.html">keep_inds_in_bounds()</a></code> </p>
        </td>
        <td><p>keep_inds_in_bounds.R</p></td>
      </tr><tr><td>
          <p><code><a href="localMaxima.html">localMaxima()</a></code> </p>
        </td>
        <td><p>Find the indices of the local maxima of a numeric vector</p></td>
      </tr><tr><td>
          <p><code><a href="localMinima.html">localMinima()</a></code> </p>
        </td>
        <td><p>Find local minima in a vector</p></td>
      </tr><tr><td>
          <p><code><a href="match.features2refs.par.html">match.features2refs.par()</a></code> </p>
        </td>
        <td><p>Match STORM features to GISSMO database using parallel computing</p></td>
      </tr><tr><td>
          <p><code><a href="padmat.html">padmat()</a></code> </p>
        </td>
        <td><p>Pad matrix with rows and columns of specified value</p></td>
      </tr><tr><td>
          <p><code><a href="pair.score.summation.html">pair.score.summation()</a></code> </p>
        </td>
        <td><p>Calculates interaction scores between all reference spectra and spectral sets.
The FSE module is one way to produce likely feature shapes supported by statistical
association of spectral points across dataset spectra. Singlets contain
very little specific information, can match to any feature shape and are
therefore excluded.</p></td>
      </tr><tr><td>
          <p><code><a href="pipeline.html">pipeline()</a></code> </p>
        </td>
        <td><p>Pipeline function to execute the entire ImperialNMRTool workflow</p></td>
      </tr><tr><td>
          <p><code><a href="pk.bounds.html">pk.bounds()</a></code> </p>
        </td>
        <td><p>Get bounds for local maxima in a vector</p></td>
      </tr><tr><td>
          <p><code><a href="pk.maxs.html">pk.maxs()</a></code> </p>
        </td>
        <td><p>Get indices of maxima of true peaks in a vector. Wrapper for extractPeaks_corr()</p></td>
      </tr><tr><td>
          <p><code><a href="plot.fit.html">plot(<i>&lt;fit&gt;</i>)</a></code> </p>
        </td>
        <td><p>Plot the spectral and feature fits</p></td>
      </tr><tr><td>
          <p><code><a href="plot_addRef.html">plot_addRef()</a></code> </p>
        </td>
        <td><p>Add reference region to an existing ggplot object</p></td>
      </tr><tr><td>
          <p><code><a href="plot_addSTOCSYLine.html">plot_addSTOCSYLine()</a></code> </p>
        </td>
        <td><p>Plot STOCSY line over the current plot</p></td>
      </tr><tr><td>
          <p><code><a href="plot_corrPocketPairs.html">plot_corrPocketPairs()</a></code> </p>
        </td>
        <td><p>Plot Stackplot of Correlation Pocket Pairs</p></td>
      </tr><tr><td>
          <p><code><a href="plot_corrPocketPairs_grid.html">plot_corrPocketPairs_grid()</a></code> </p>
        </td>
        <td><p>Plot correlation pairs of pockets in a grid</p></td>
      </tr><tr><td>
          <p><code><a href="plot_correlation_pocket.html">plot_correlation_pocket()</a></code> </p>
        </td>
        <td><p>Plot correlation window for a given pocket</p></td>
      </tr><tr><td>
          <p><code><a href="plot_correlation_pockets_grid.html">plot_correlation_pockets_grid()</a></code> </p>
        </td>
        <td><p>Plot correlation pockets in a grid</p></td>
      </tr><tr><td>
          <p><code><a href="plot_stocsy_corrWindow.html">plot_stocsy_corrWindow()</a></code> </p>
        </td>
        <td><p>Plot a correlation window with local minima</p></td>
      </tr><tr><td>
          <p><code><a href="plot_stormRefRegions_grid.html">plot_stormRefRegions_grid()</a></code> </p>
        </td>
        <td><p>Plot storm Results for reference regions in grid format</p></td>
      </tr><tr><td>
          <p><code><a href="plot_storm_refRegions.html">plot_storm_refRegions()</a></code> </p>
        </td>
        <td><p>Plot the STORM results</p></td>
      </tr><tr><td>
          <p><code><a href="plot_umap.scores.html">plot_umap.scores()</a></code> </p>
        </td>
        <td><p>Plot UMAP Scores</p></td>
      </tr><tr><td>
          <p><code><a href="plot_umap.scores.df.html">plot_umap.scores.df()</a></code> </p>
        </td>
        <td><p>Plot UMAP scores</p></td>
      </tr><tr><td>
          <p><code><a href="prepRefs.for.dataset.html">prepRefs.for.dataset()</a></code> </p>
        </td>
        <td><p>Prepare reference spectra for matching to a dataset
To match features from a dataset to reference spectra in fine detail, they need
to have the same spectral axis, more or less. This function interpolates each
reference spectrum in the list to the dataset ppm axis, and then filters its
signal to avoid inclusion of noise/zeros, which are replaced with NAs so that
cross-correlations, etc. are minimized. In future versions, a solvent region
could be provided for each (or all) that will be replaced with NAs to avoid
matching that peak.</p></td>
      </tr><tr><td>
          <p><code><a href="project_features.stackplot.html">project_features.stackplot()</a></code> </p>
        </td>
        <td><p>Generate a stacked area plot of the spectra for each feature in <code>xmat</code>, overlaid with the corresponding best-fit features</p></td>
      </tr><tr><td>
          <p><code><a href="prominences.html">prominences()</a></code> </p>
        </td>
        <td><p>Calculate the prominence of each peak</p></td>
      </tr><tr><td>
          <p><code><a href="range.groups.html">range(<i>&lt;groups&gt;</i>)</a></code> </p>
        </td>
        <td><p>Divide Ranges into Groups with Overlapping Sections</p></td>
      </tr><tr><td>
          <p><code><a href="range.intersect.html">range(<i>&lt;intersect&gt;</i>)</a></code> </p>
        </td>
        <td><p>Calculate the intersection or union of two numeric ranges</p></td>
      </tr><tr><td>
          <p><code><a href="range.intersect.all.html">range(<i>&lt;intersect.all&gt;</i>)</a></code> </p>
        </td>
        <td><p>Calculate pairwise intersection or union between ranges</p></td>
      </tr><tr><td>
          <p><code><a href="run.labels.html">run.labels()</a></code> </p>
        </td>
        <td><p>Assigns a unique label to each run of 1s in a binary vector.</p></td>
      </tr><tr><td>
          <p><code><a href="runFeatureSpace.shiny.html">runFeatureSpace.shiny()</a></code> </p>
        </td>
        <td><p>Run Feature Space Shiny app</p></td>
      </tr><tr><td>
          <p><code><a href="runs.labelBy.lengths.html">runs.labelBy.lengths()</a></code> </p>
        </td>
        <td><p>Computes the lengths of runs of 1s in a binary vector.</p></td>
      </tr><tr><td>
          <p><code><a href="scale.between.html">scale(<i>&lt;between&gt;</i>)</a></code> </p>
        </td>
        <td><p>Scale values in a vector to be between a specified range.</p></td>
      </tr><tr><td>
          <p><code><a href="scale.to.minmax.html">scale(<i>&lt;to.minmax&gt;</i>)</a></code> </p>
        </td>
        <td><p>Scale a vector to the range of a matrix, element-wise</p></td>
      </tr><tr><td>
          <p><code><a href="score.matches.html">score.matches()</a></code> </p>
        </td>
        <td><p>score.matches function</p></td>
      </tr><tr><td>
          <p><code><a href="score.wasserstein.html">score.wasserstein()</a></code> </p>
        </td>
        <td><p>Calculate the Wasserstein distance between two vectors using transport::wasserstein1d.</p></td>
      </tr><tr><td>
          <p><code><a href="setup.html">setup()</a></code> </p>
        </td>
        <td><p>Setup function for initializing the analysis environment</p></td>
      </tr><tr><td>
          <p><code><a href="shiftedInds_toVals.html">shiftedInds_toVals()</a></code> </p>
        </td>
        <td><p>Extract values from a matrix given shifted indices</p></td>
      </tr><tr><td>
          <p><code><a href="simplePlot.html">simplePlot()</a></code> </p>
        </td>
        <td><p>Create a simple plot using ggplot2</p></td>
      </tr><tr><td>
          <p><code><a href="slidingCorr.html">slidingCorr()</a></code> </p>
        </td>
        <td><p>Calculate sliding window correlation matrix, and label correlation peaks (pockets)</p></td>
      </tr><tr><td>
          <p><code><a href="sortPairs.html">sortPairs()</a></code> </p>
        </td>
        <td><p>sortPairs.R</p></td>
      </tr><tr><td>
          <p><code><a href="sortedStack.html">sortedStack()</a></code> </p>
        </td>
        <td><p>sortedStack</p></td>
      </tr><tr><td>
          <p><code><a href="span.html">span()</a></code> </p>
        </td>
        <td><p>Calculates the span of a numeric vector</p></td>
      </tr><tr><td>
          <p><code><a href="stackplot.html">stackplot()</a></code> </p>
        </td>
        <td><p>Plot stacked spectra with ggplot2 and ggridges</p></td>
      </tr><tr><td>
          <p><code><a href="stocsy_slim.html">stocsy_slim()</a></code> </p>
        </td>
        <td><p>Calculate Pearson correlations and covariance using STOCSY for a subset of variables.</p></td>
      </tr><tr><td>
          <p><code><a href="storm_pairplay.html">storm_pairplay()</a></code> </p>
        </td>
        <td><p>storm_pairplay: Run modified STORM on the provided spectral region and ref shape.
Built for accepting corrPocketPairs results. Notes:</p></td>
      </tr><tr><td>
          <p><code><a href="sub2indR.html">sub2indR()</a></code> </p>
        </td>
        <td><p>Convert Subscripts to Linear Indices in Column-Major Order</p></td>
      </tr><tr><td>
          <p><code><a href="tina.html">tina()</a></code> </p>
        </td>
        <td><p>Tina Function. Tina Is Not Alignment.</p></td>
      </tr><tr><td>
          <p><code><a href="tina_combineFeatures.html">tina_combineFeatures()</a></code> </p>
        </td>
        <td><p>Combines and clusters features in a matrix</p></td>
      </tr><tr><td>
          <p><code><a href="tina_setup.html">tina_setup()</a></code> </p>
        </td>
        <td><p>TINA Setup</p></td>
      </tr><tr><td>
          <p><code><a href="trim.sides.html">trim.sides()</a></code> </p>
        </td>
        <td><p>Trim the sides of a matrix to remove columns with all NA values</p></td>
      </tr><tr><td>
          <p><code><a href="vectInds.html">vectInds()</a></code> </p>
        </td>
        <td><p>Return the index/indices in a vector closest to given value(s).</p></td>
      </tr><tr><td>
          <p><code><a href="xcorr.html">xcorr()</a></code> </p>
        </td>
        <td><p>Calculate cross-correlation between reference and shifted spectra</p></td>
      </tr><tr><td>
          <p><code><a href="xcorr_localign.html">xcorr_localign()</a></code> </p>
        </td>
        <td><p>Cross-correlation with local alignment</p></td>
      </tr></tbody></table></div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Michael T. Judge PostDoc / Developer, Goncalo G. Graca PostDoc / Developer, Callum Martin Developer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

